package edu.osu.cs362;
/**
 *  This class provides a basic set of test cases for the
 *  CalDay class.
 */
import java.util.Calendar;
import java.util.GregorianCalendar;
import java.util.Iterator;
import java.util.LinkedList;
import java.util.Random;

import org.junit.Test;

import static org.junit.Assert.*;

public class CalDayTest {

	//Test the default constructor for the normal calendar (CalDay)
	@Test
	public void test01()  throws Throwable  {
		CalDay calendarDay = new CalDay();
		// Invalid before initialization
		assertFalse(calendarDay.isValid());
	}

	//Test the constructor for the Gregorian Calendar (GregorianCalendar)
    @Test
    public void test02() {
		GregorianCalendar calendar = new GregorianCalendar(2018, 6, 17);
		CalDay calendarDay = new CalDay(calendar);

		assertEquals(2018, calendarDay.year);
		assertEquals(6, calendarDay.month);
		assertEquals(17, calendarDay.day);
    }

    //Tests iterators through both calendar types
    @Test
	public void test03() {
		int year = 2017,
			month = 7,
			day = 1;

		GregorianCalendar calendar = new GregorianCalendar(year, month, day);
		CalDay calendarDay = new CalDay(calendar);
		Appt appointment1 = new Appt(6, 45, day, month, year, "Wake Up", null),
			appointment2 = new Appt(22, 45, day, month, year, "Go to Sleep", null);

		calendarDay.addAppt(appointment1);
		calendarDay.addAppt(appointment2);

		Iterator<?> apptsIterator = calendarDay.iterator();

		// Appts from CalDay's iterator should match originals
		assertEquals(appointment1, apptsIterator.next());
		assertEquals(appointment2, apptsIterator.next());

		// Try iterator with invalid CalDay
		calendarDay = new CalDay();
		assertEquals(null, calendarDay.iterator());
	}

    //Test calendarDay.getYear(), calendarDay.getMonth(), calendarDay.getDay()
    @Test
	public void test04() {
    	int year = 2017,
    		month = 5,
    		day = 25;
    	GregorianCalendar gregCalendar = new GregorianCalendar(year, month, day);
    	CalDay calendarDay = new CalDay(gregCalendar);

    	// Getters should match values used in construction
    	assertEquals(year, calendarDay.getYear());
    	assertEquals(month, calendarDay.getMonth());
    	assertEquals(day, calendarDay.getDay());
	}

    //Test addAppt()
    @Test
	public void test05() {
    	Random rand = new Random();

		int startHour,
			startMinute,
			startDay,
			startMonth,
			startYear;
		short length;
		String title,
			description;
		boolean isValid;

    	GregorianCalendar gregCalendar;
    	CalDay calendarDay;
    	for(int test = 0; test < 10000; test++){
			startHour = rand.nextInt(30);
			startMinute = rand.nextInt(70);
			startDay = rand.nextInt(50);
			startMonth = rand.nextInt(20);
			startYear = rand.nextInt(3000);
			length = (byte)(rand.nextInt(100));
			char[] text = new char[length];
			for (int i = 0; i < length; i++)
		      text[i] = (char)(rand.nextInt('~' - ' ') + ' ');
			text[length - 1] = '\0';
			title = new String(text);
			length = (byte)(rand.nextInt(200));
			text = new char[length];
			for (int i = 0; i < length; i++)
		      text[i] = (char)(rand.nextInt('~' - ' ') + ' ');
			text[length - 1] = '\0';
			description = new String(text);
	    	gregCalendar = new GregorianCalendar(startYear, startMonth, startDay);
	    	calendarDay = new CalDay(gregCalendar);
	
	    	Appt appointment = new Appt(startHour, startMinute, startDay, startMonth, startYear, title, description);
	
	    	// Ensure appointments are valid
	    	isValid = appointment.getValid();
	
	    	// There are no existing Appts
			assertEquals(0, calendarDay.getSizeAppts());
	
			if(isValid){
		    	// One appointment added
				calendarDay.addAppt(appointment);
				assertEquals(appointment, calendarDay.getAppts().getFirst());
			}
			else{
				// Adding invalid Appts should not affect CalDay size
				int size = calendarDay.getSizeAppts();
				assertEquals(size, calendarDay.getSizeAppts());
			}
    	}
	}


    //Test toString()
	@Test
	public void test06() {
		int year = 2017,
			month  = 5,
			day = 26;

		GregorianCalendar gregCalendar = new GregorianCalendar(year, month, day);
		CalDay calendarDay = new CalDay(gregCalendar);

		Appt appointment1 = new Appt(18, 10, day, month, year, "Evening", null),
			appointment2 = new Appt(7, 30, day, month, year, "Morning", null);

		calendarDay.addAppt(appointment1);
		calendarDay.addAppt(appointment2);

		//Appointments added successfully
		assertEquals(2, calendarDay.getSizeAppts());

		// String is correct
		assertEquals("\t --- 5/26/2017 --- \n" +
				" --- -------- Appointments ------------ --- \n" +
				"\t5/26/2017 at 7:30am ,Morning, \n" +
				" \t5/26/2017 at 6:10pm ,Evening, \n" +
				" \n",
				calendarDay.toString());

		// Invalid CalDay should print nothing
		calendarDay.valid = false;
		assertEquals("", calendarDay.toString());
	}
}
